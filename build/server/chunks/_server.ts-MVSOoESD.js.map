{"version":3,"file":"_server.ts-MVSOoESD.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/rooms/scenes/_server.ts.js"],"sourcesContent":["import { p as pool, f as formatRow } from \"../../../../../chunks/db.js\";\nimport \"../../../../../chunks/index.js\";\nimport { h as hasPerms } from \"../../../../../chunks/perms.js\";\nconst PUT = async ({ request, locals }) => {\n  const scene = await request.json();\n  if (!locals.user?.id || !scene.id)\n    ;\n  console.log(scene.id);\n  const [[room]] = await pool.execute(\"select user_id, id from rooms where uuid = ?\", [scene.id]);\n  console.log(room.user_id, locals.user?.id);\n  if (room && room.user_id !== Number(locals.user?.id)) {\n    const [editors] = await pool.execute(\"select * from editors where room_id = ? AND user_id = ?\", [scene.id, locals.user?.id]);\n    if (editors.length === 0 || !editors.some((e) => e.user_id === locals.user?.id))\n      ;\n  }\n  let [query, params] = formatRow({ ...scene, room_id: room.id, id: null });\n  console.log(query, params);\n  await pool.execute(`insert into scenes ${query}`, params);\n  return new Response(null, { status: 200 });\n};\nconst DELETE = async ({ request, locals }) => {\n  const data = await request.json();\n  console.log(\"data: \", data);\n  if (!locals.user?.id || !data.scene_id || !data.room_id || !hasPerms(data.room_id, locals.user?.id))\n    ;\n  await pool.execute(`delete from scenes where id = ?`, [data.scene_id]);\n  return new Response(null, { status: 200 });\n};\nexport {\n  DELETE,\n  PUT\n};\n"],"names":[],"mappings":";;;;;AAGK,MAAC,GAAG,GAAG,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK;AAC3C,EAAE,MAAM,KAAK,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AACrC,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE;AACnC,IAAI,CAAC;AACL,EAAE,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;AACxB,EAAE,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,8CAA8C,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;AAClG,EAAE,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;AAC7C,EAAE,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,KAAK,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,EAAE,CAAC,EAAE;AACxD,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,yDAAyD,EAAE,CAAC,KAAK,CAAC,EAAE,EAAE,MAAM,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,CAAC;AACjI,IAAI,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,KAAK,MAAM,CAAC,IAAI,EAAE,EAAE,CAAC;AACnF,MAAM,CAAC;AACP,GAAG;AACH,EAAE,IAAI,CAAC,KAAK,EAAE,MAAM,CAAC,GAAG,SAAS,CAAC,EAAE,GAAG,KAAK,EAAE,OAAO,EAAE,IAAI,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,CAAC,CAAC;AAC5E,EAAE,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;AAC7B,EAAE,MAAM,IAAI,CAAC,OAAO,CAAC,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;AAC5D,EAAE,OAAO,IAAI,QAAQ,CAAC,IAAI,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AAC7C,EAAE;AACG,MAAC,MAAM,GAAG,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK;AAC9C,EAAE,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AACpC,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;AAC9B,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,IAAI,EAAE,EAAE,CAAC;AACrG,IAAI,CAAC;AACL,EAAE,MAAM,IAAI,CAAC,OAAO,CAAC,CAAC,+BAA+B,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;AACzE,EAAE,OAAO,IAAI,QAAQ,CAAC,IAAI,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AAC7C;;;;"}